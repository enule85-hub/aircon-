<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì—ì–´ì»¨ ì„¤ì¹˜ ê²¬ì  ê³„ì‚°ê¸°</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800;900&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --primary: #1B3A6B;
      --accent: #2563eb;
      --primary-light: #e8eef8;
      --bg: #f0f4fa;
      --card: #ffffff;
      --border: #c9d8ee;
      --text: #1a2640;
      --sub: #5a7099;
      --card-shadow: 0 4px 24px rgba(27,58,107,0.10);
    }

    body {
      font-family: 'Pretendard', 'Noto Sans KR', sans-serif;
      background: var(--bg);
      min-height: 100vh;
      color: var(--text);
      overflow-x: hidden;
    }

    header {
      background: linear-gradient(135deg, #1B3A6B 0%, #2563eb 100%);
      color: white; padding: 28px 20px 22px;
      text-align: center; position: relative; overflow: hidden;
    }
    header::before { content:''; position:absolute; top:-40px; right:-40px; width:180px; height:180px; border-radius:50%; background:rgba(255,255,255,0.08); }
    header::after  { content:''; position:absolute; bottom:-30px; left:-20px; width:120px; height:120px; border-radius:50%; background:rgba(255,255,255,0.06); }
    header h1 { font-size:1.5rem; font-weight:900; letter-spacing:-0.5px; position:relative; }
    header p  { margin-top:6px; font-size:0.85rem; opacity:0.88; position:relative; }

    /* ì§„í–‰ íƒ­ */
    .step-tabs {
      display: flex; align-items: flex-start; justify-content: center;
      padding: 18px 16px 0; background: var(--bg);
    }
    .tab-item {
      display: flex; flex-direction: column; align-items: center;
      position: relative; flex: 1; max-width: 72px;
    }
    .tab-item:not(:last-child)::after {
      content: ''; position: absolute;
      top: 17px; left: calc(50% + 18px);
      width: calc(100% - 36px); height: 2px;
      background: var(--border); transition: background 0.5s ease;
    }
    .tab-item.done:not(:last-child)::after { background: var(--accent); }
    .tab-num {
      width: 34px; height: 34px; border-radius: 50%;
      border: 2.5px solid var(--border); background: white;
      display: flex; align-items: center; justify-content: center;
      font-size: 0.82rem; font-weight: 800; color: var(--sub);
      position: relative; z-index: 1;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .tab-item.active .tab-num {
      border-color: var(--accent);
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white; box-shadow: 0 2px 14px rgba(37,99,235,0.4);
      transform: scale(1.12);
    }
    .tab-item.done .tab-num { border-color: var(--accent); background: var(--accent); color: white; }
    .tab-num-inner { line-height:1; }
    .tab-item.done .tab-num-inner { display: none; }
    .tab-check { display: none; font-size: 0.78rem; }
    .tab-item.done .tab-check { display: block; }
    .tab-label {
      margin-top: 5px; font-size: 0.6rem; font-weight: 600;
      color: var(--sub); text-align: center; white-space: nowrap; transition: color 0.3s;
    }
    .tab-item.active .tab-label { color: var(--accent); font-weight: 700; }
    .tab-item.done .tab-label   { color: var(--accent); }

    /* ìŠ¬ë¼ì´ë” */
    .slider-wrap { max-width: 560px; margin: 0 auto; padding: 14px 16px 0; overflow: hidden; }

    /* ì¹´ë“œ */
    .step-card {
      background: var(--card); border-radius: 20px;
      box-shadow: var(--card-shadow); padding: 22px 20px 20px;
      border: 1.5px solid var(--border); width: 100%;
    }
    .step-card.enter-right { animation: enterRight 0.42s cubic-bezier(0.25,0.46,0.45,0.94) both; }
    .step-card.enter-left  { animation: enterLeft  0.42s cubic-bezier(0.25,0.46,0.45,0.94) both; }
    @keyframes enterRight { from{opacity:0;transform:translateX(60px) scale(0.97)} to{opacity:1;transform:translateX(0) scale(1)} }
    @keyframes enterLeft  { from{opacity:0;transform:translateX(-60px) scale(0.97)} to{opacity:1;transform:translateX(0) scale(1)} }

    .step-header {
      display: flex; align-items: center; gap: 10px;
      margin-bottom: 16px; padding-bottom: 13px;
      border-bottom: 1.5px solid var(--primary-light);
    }
    .step-icon { font-size: 1.2rem; }
    .step-title { font-size: 1rem; font-weight: 800; color: var(--text); }

    .options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .options.cols-1 { grid-template-columns: 1fr; }
    .options.cols-3 { grid-template-columns: 1fr 1fr 1fr; }

    .opt-btn {
      border: 1.5px solid var(--border); background: #f5f8ff;
      border-radius: 14px; padding: 15px 12px;
      font-family: inherit; font-size: 0.9rem; font-weight: 600;
      color: var(--text); cursor: pointer;
      transition: all 0.18s; text-align: center; line-height: 1.5;
    }
    .opt-btn:hover { border-color: var(--accent); background: var(--primary-light); transform: translateY(-2px); }
    .opt-btn.selected {
      border-color: var(--primary);
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white; font-weight: 700;
      box-shadow: 0 4px 16px rgba(27,58,107,0.25);
    }

    /* ì§€ì—­ ì„ íƒ ì…€ë ‰íŠ¸ */
    .region-select-wrap { display: flex; flex-direction: column; gap: 14px; }
    .region-group { display: flex; flex-direction: column; gap: 6px; }
    .input-label { font-size: 0.85rem; font-weight: 600; color: var(--sub); display: block; }

    .select-row { display: flex; gap: 8px; }
    .region-select {
      flex: 1; padding: 13px 14px; border-radius: 12px;
      border: 1.5px solid var(--border); font-family: inherit;
      font-size: 0.92rem; color: var(--text); background: white;
      outline: none; cursor: pointer; transition: border-color 0.2s;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%235a7099' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      padding-right: 36px;
    }
    .region-select:focus { border-color: var(--accent); }
    .region-select:disabled { background-color: #f5f8ff; color: #aab8cc; cursor: not-allowed; }

    /* ê±°ë¦¬ ë±ƒì§€ */
    .distance-badge {
      display: none;
      align-items: center; gap: 8px;
      background: var(--primary-light);
      border: 1.5px solid var(--border);
      border-radius: 12px; padding: 10px 14px;
      margin-top: 4px;
    }
    .distance-badge.show { display: flex; }
    .distance-badge .dist-km { font-size: 0.88rem; font-weight: 700; color: var(--primary); }
    .distance-badge .dist-fee {
      margin-left: auto; font-size: 0.95rem; font-weight: 800;
      color: #e8380d;
    }
    .distance-badge .dist-fee.free { color: #16a34a; }

    .desc-box {
      margin-top: 0; background: #e8eef8; border: 1px solid #b8cce8;
      border-radius: 10px; font-size: 0.82rem; color: var(--primary);
      font-weight: 600;
      max-height: 0; overflow: hidden; opacity: 0;
      transition: max-height 0.35s ease, opacity 0.35s ease, padding 0.35s ease, margin 0.35s ease;
      padding-top: 0; padding-bottom: 0;
    }
    .desc-box.show { max-height: 60px; opacity: 1; padding: 10px 14px; margin-top: 10px; }

    .extra-item {
      display: flex; align-items: center; justify-content: space-between;
      padding: 13px 0; border-bottom: 1px solid #eaf0f8; gap: 12px;
    }
    .extra-item:last-of-type { border-bottom: none; }
    .extra-label { font-size: 0.9rem; font-weight: 600; flex: 1; }
    .extra-label small { display: block; color: var(--sub); font-size: 0.78rem; margin-top: 3px; }
    .extra-controls { display: flex; align-items: center; gap: 8px; }

    .cnt-btn {
      width: 36px; height: 36px; border-radius: 50%;
      border: 1.5px solid #b8cce8; background: var(--primary-light);
      font-size: 1.2rem; font-weight: 700; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--primary); transition: all 0.15s;
    }
    .cnt-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }
    .cnt-val { font-size: 1rem; font-weight: 800; min-width: 26px; text-align: center; color: var(--primary); }

    .toggle-btn {
      width: 50px; height: 28px; border-radius: 14px; border: none;
      background: #d0ddf0; cursor: pointer; position: relative;
      transition: background 0.3s; flex-shrink: 0;
    }
    .toggle-btn::after {
      content: ''; position: absolute; top: 4px; left: 4px;
      width: 20px; height: 20px; border-radius: 50%; background: white;
      transition: left 0.3s cubic-bezier(0.34,1.56,0.64,1);
      box-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }
    .toggle-btn.on { background: linear-gradient(135deg, var(--primary), var(--accent)); }
    .toggle-btn.on::after { left: 26px; }

    .nav-row { display: flex; gap: 10px; margin-top: 18px; }
    .btn-prev {
      flex: 0 0 auto; padding: 13px 18px; border-radius: 12px;
      border: 1.5px solid var(--border); background: white;
      font-family: inherit; font-size: 0.9rem; font-weight: 700;
      color: var(--sub); cursor: pointer; transition: all 0.18s;
    }
    .btn-prev:hover { border-color: var(--primary); color: var(--primary); }
    .btn-next {
      flex: 1; padding: 14px; border-radius: 12px; border: none;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white; font-family: inherit; font-size: 0.95rem; font-weight: 800;
      cursor: pointer; transition: all 0.2s;
      box-shadow: 0 4px 14px rgba(27,58,107,0.25);
    }
    .btn-next:hover { opacity: 0.9; transform: translateY(-1px); }
    .btn-next:disabled { background: #c8d5e8; box-shadow: none; cursor: not-allowed; transform: none; }

    .container-bottom { max-width: 560px; margin: 0 auto; padding: 14px 16px 50px; }
    .result-card {
      background: linear-gradient(135deg, #1B3A6B 0%, #2563eb 100%);
      border-radius: 20px; padding: 26px 22px;
      color: white; box-shadow: 0 8px 32px rgba(27,58,107,0.25);
    }
    .result-card.enter-right { animation: enterRight 0.42s cubic-bezier(0.25,0.46,0.45,0.94) both; }
    .result-title { font-size: 0.88rem; opacity: 0.88; margin-bottom: 6px; font-weight: 500; }
    .result-total { font-size: 2.3rem; font-weight: 900; letter-spacing: -1.5px; }
    .result-total span { font-size: 1rem; font-weight: 500; opacity: 0.85; }
    .result-breakdown { margin-top: 18px; background: rgba(0,0,0,0.15); border-radius: 12px; padding: 14px; }
    .breakdown-row { display: flex; justify-content: space-between; font-size: 0.85rem; padding: 5px 0; opacity: 0.92; }
    .breakdown-row.total-row { border-top: 1px solid rgba(255,255,255,0.25); margin-top: 10px; padding-top: 12px; font-weight: 800; font-size: 1rem; opacity: 1; }
    .notice { margin-top: 14px; background: rgba(0,0,0,0.12); border-radius: 10px; padding: 12px; font-size: 0.78rem; line-height: 1.7; opacity: 0.88; }

    .kakao-share-btn {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      width: 100%; margin-top: 12px; padding: 15px; border-radius: 14px;
      border: none; background: #FEE500;
      font-family: inherit; font-size: 0.95rem; font-weight: 800;
      color: #191919; cursor: pointer; transition: all 0.18s;
      box-shadow: 0 2px 10px rgba(254,229,0,0.4);
    }
    .kakao-share-btn:hover { background: #f0d800; transform: translateY(-1px); }
    .kakao-share-btn img { width: 22px; height: 22px; }

    .reset-btn {
      display: block; width: 100%; margin-top: 10px; padding: 14px;
      border-radius: 14px; border: 1.5px solid #b8cce8; background: white;
      font-family: inherit; font-size: 0.95rem; font-weight: 700;
      color: var(--primary); cursor: pointer; transition: all 0.18s;
    }
    .reset-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }

    .hidden { display: none !important; }
    select.input-field { cursor: pointer; }

    /* ì´ì „ btn (ë‹¨ë…) */
    .solo-prev {
      margin-top: 16px; padding: 10px 16px; border-radius: 12px;
      border: 1.5px solid var(--border); background: white;
      font-family: inherit; font-size: 0.88rem; font-weight: 700;
      color: var(--sub); cursor: pointer; transition: all 0.18s;
    }
    .solo-prev:hover { border-color: var(--primary); color: var(--primary); }
  </style>
</head>
<body>

<header>
  <h1>â„ï¸ ì—ì–´ì»¨ ì„¤ì¹˜ ê²¬ì  ê³„ì‚°ê¸°</h1>
  <p>í•­ëª©ì„ ì„ íƒí•˜ì‹œë©´ ì˜ˆìƒ ê²¬ì ì„ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”</p>
</header>

<!-- ì§„í–‰ íƒ­ -->
<div class="step-tabs" id="step-tabs">
  <div class="tab-item active" id="tab1">
    <div class="tab-num"><span class="tab-num-inner">1</span><span class="tab-check">âœ“</span></div>
    <div class="tab-label">ì„¤ì¹˜ìœ í˜•</div>
  </div>
  <div class="tab-item" id="tab2">
    <div class="tab-num"><span class="tab-num-inner">2</span><span class="tab-check">âœ“</span></div>
    <div class="tab-label">ì´ì „ì¥ì†Œ</div>
  </div>
  <div class="tab-item" id="tab3">
    <div class="tab-num"><span class="tab-num-inner">3</span><span class="tab-check">âœ“</span></div>
    <div class="tab-label">ì—ì–´ì»¨ì¢…ë¥˜</div>
  </div>
  <div class="tab-item" id="tab4">
    <div class="tab-num"><span class="tab-num-inner">4</span><span class="tab-check">âœ“</span></div>
    <div class="tab-label">ì œì¡°ì‚¬Â·ë…„ì‹</div>
  </div>
  <div class="tab-item" id="tab5">
    <div class="tab-num"><span class="tab-num-inner">5</span><span class="tab-check">âœ“</span></div>
    <div class="tab-label">ì¶”ê°€ì˜µì…˜</div>
  </div>
</div>

<div class="slider-wrap" id="slider-wrap">

  <!-- 1ë‹¨ê³„: ì„¤ì¹˜ ìœ í˜• -->
  <div class="step-card enter-right" id="step1">
    <div class="step-header">
      <span class="step-icon">ğŸ </span>
      <div class="step-title">ì„¤ì¹˜ ìœ í˜• ì„ íƒ</div>
    </div>
    <div class="options cols-1">
      <button class="opt-btn" onclick="selectOpt(1,'ì´ì „ì„¤ì¹˜',this)">
        ì´ì „ì„¤ì¹˜<br><small style="font-weight:400;font-size:0.78rem;opacity:0.7">ê¸°ì¡´ ì—ì–´ì»¨ì„ ë‹¤ë¥¸ ì¥ì†Œë¡œ ì´ë™</small>
      </button>
      <button class="opt-btn" onclick="selectOpt(1,'ì¬ì„¤ì¹˜',this)">
        ì¬ì„¤ì¹˜<br><small style="font-weight:400;font-size:0.78rem;opacity:0.7">ê¸°ì¡´ ì¥ì†Œì— ë‹¤ì‹œ ì„¤ì¹˜ (ì¤€ë¹„ì¤‘)</small>
      </button>
    </div>
  </div>

  <!-- 2ë‹¨ê³„: ì§€ì—­ ì„ íƒ -->
  <div class="step-card hidden" id="step2">
    <div class="step-header">
      <span class="step-icon">ğŸ“</span>
      <div class="step-title">ì´ì „ ì¥ì†Œ ë° ì„¤ì¹˜ ì¥ì†Œ</div>
    </div>
    <div class="region-select-wrap">

      <!-- ì¶œë°œì§€ -->
      <div class="region-group">
        <label class="input-label">ğŸ“ ì´ì „ ì¥ì†Œ (í˜„ì¬ ì—ì–´ì»¨ ìœ„ì¹˜)</label>
        <div class="select-row">
          <select class="region-select" id="from-sido" onchange="onSidoChange('from')">
            <option value="">ì‹œ/ë„ ì„ íƒ</option>
          </select>
          <select class="region-select" id="from-sigungu" onchange="onSigunguChange()" disabled>
            <option value="">êµ¬/êµ°/ì‹œ ì„ íƒ</option>
          </select>
        </div>
      </div>

      <!-- ë„ì°©ì§€ -->
      <div class="region-group">
        <label class="input-label">ğŸ“ ì„¤ì¹˜ ì¥ì†Œ (ìƒˆë¡œ ì„¤ì¹˜í•  ìœ„ì¹˜)</label>
        <div class="select-row">
          <select class="region-select" id="to-sido" onchange="onSidoChange('to')">
            <option value="">ì‹œ/ë„ ì„ íƒ</option>
          </select>
          <select class="region-select" id="to-sigungu" onchange="onSigunguChange()" disabled>
            <option value="">êµ¬/êµ°/ì‹œ ì„ íƒ</option>
          </select>
        </div>
      </div>

      <!-- ê±°ë¦¬ ë±ƒì§€ -->
      <div class="distance-badge" id="distance-badge">
        <span>ğŸš—</span>
        <span class="dist-km" id="dist-km-text"></span>
        <span class="dist-fee" id="dist-fee-text"></span>
      </div>

    </div>
    <div class="nav-row">
      <button class="btn-prev" onclick="goPrev(2)">â† ì´ì „</button>
      <button class="btn-next" id="location-next-btn" onclick="goNext(2)" disabled>ë‹¤ìŒ ë‹¨ê³„ â†’</button>
    </div>
  </div>

  <!-- 3ë‹¨ê³„: ì—ì–´ì»¨ ì¢…ë¥˜ -->
  <div class="step-card hidden" id="step3">
    <div class="step-header">
      <span class="step-icon">â„ï¸</span>
      <div class="step-title">ì—ì–´ì»¨ ì¢…ë¥˜ ì„ íƒ</div>
    </div>
    <div class="options cols-1">
      <button class="opt-btn" onclick="selectOpt(3,'ë²½ê±¸ì´',this)">ë²½ê±¸ì´ <span style="font-weight:400;opacity:0.75;font-size:0.88rem">160,000ì›</span><br><small style="font-weight:400;font-size:0.78rem;opacity:0.6">(ê¸°ë³¸ì„¤ì¹˜ë¹„ ë°°ê´€5m+ê°€ìŠ¤ì¶©ì „+íƒ€ê³µ1íšŒ)</small></button>
      <button class="opt-btn" onclick="selectOpt(3,'ìŠ¤íƒ ë“œ',this)">ìŠ¤íƒ ë“œ <span style="font-weight:400;opacity:0.75;font-size:0.88rem">190,000ì›</span><br><small style="font-weight:400;font-size:0.78rem;opacity:0.6">(ê¸°ë³¸ì„¤ì¹˜ë¹„ ë°°ê´€5m+ê°€ìŠ¤ì¶©ì „+íƒ€ê³µ1íšŒ)</small></button>
      <button class="opt-btn" onclick="selectOpt(3,'íˆ¬ì¸ì›',this)">íˆ¬ì¸ì› <span style="font-weight:400;opacity:0.75;font-size:0.88rem">310,000ì›</span><br><small style="font-weight:400;font-size:0.78rem;opacity:0.6">(ê¸°ë³¸ì„¤ì¹˜ë¹„ ë²½ê±¸ì´5m+ìŠ¤íƒ ë“œ5m+ê°€ìŠ¤ì¶©ì „+íƒ€ê³µ2íšŒ)</small></button>
      <button class="opt-btn" onclick="selectOpt(3,'ëƒ‰ë‚œë°©ë²½ê±¸ì´',this)">ëƒ‰ë‚œë°©ê¸° ë²½ê±¸ì´ <span style="font-weight:400;opacity:0.75;font-size:0.88rem">ë³„ë„ë¬¸ì˜</span></button>
      <button class="opt-btn" onclick="selectOpt(3,'ëƒ‰ë‚œë°©ìŠ¤íƒ ë“œ',this)">ëƒ‰ë‚œë°©ê¸° ìŠ¤íƒ ë“œ <span style="font-weight:400;opacity:0.75;font-size:0.88rem">ë³„ë„ë¬¸ì˜</span></button>
    </div>
    <button class="solo-prev" onclick="goPrev(3)">â† ì´ì „</button>
  </div>

  <!-- 4ë‹¨ê³„: ì œì¡°ì‚¬ + ë…„ì‹ -->
  <div class="step-card hidden" id="step4">
    <div class="step-header">
      <span class="step-icon">ğŸ­</span>
      <div class="step-title">ì œì¡°ì‚¬ ë° ë…„ì‹ ì„ íƒ</div>
    </div>
    <div class="options cols-3" style="margin-bottom:14px;">
      <button class="opt-btn" onclick="selectOpt(4,'LG',this)">LG</button>
      <button class="opt-btn" onclick="selectOpt(4,'ì‚¼ì„±',this)">ì‚¼ì„±</button>
      <button class="opt-btn" onclick="selectOpt(4,'ìºë¦¬ì–´',this)">ìºë¦¬ì–´</button>
      <button class="opt-btn" onclick="selectOpt(4,'ìœ„ë‹ˆì•„',this)">ìœ„ë‹ˆì•„</button>
      <button class="opt-btn" onclick="selectOpt(4,'ê¸°íƒ€',this)">ê¸°íƒ€</button>
    </div>
    <div class="desc-box" id="smartlink-desc">
      ğŸ”§ <strong>ìŠ¤ë§ˆíŠ¸ë§í¬ (+40,000ì›)</strong> â€” ì‚¼ì„± ì „ìš© ë°°ê´€ì—°ê²°ë¶€ì†ì´ ì¶”ê°€ë©ë‹ˆë‹¤.
    </div>
    <div style="margin-top:14px;">
      <label class="input-label" style="margin-bottom:6px;">ğŸ“… ì—ì–´ì»¨ ë…„ì‹</label>
      <select class="region-select" id="year-select" onchange="selectYear(this.value)" style="width:100%;">
        <option value="">ë…„ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
      </select>
    </div>
    <button class="solo-prev" onclick="goPrev(4)">â† ì´ì „</button>
  </div>

  <!-- 5ë‹¨ê³„: ì¶”ê°€ ì˜µì…˜ -->
  <div class="step-card hidden" id="step5">
    <div class="step-header">
      <span class="step-icon">âš™ï¸</span>
      <div class="step-title">ì¶”ê°€ ì˜µì…˜ ì„ íƒ</div>
    </div>
    <div class="extra-item">
      <div class="extra-label">ë°°ê´€ ì¶”ê°€<small id="pipe-price-label">1më‹¹ 15,000ì›</small></div>
      <div class="extra-controls">
        <button class="cnt-btn" onclick="changePipe(-1)">âˆ’</button>
        <div class="cnt-val" id="pipe-cnt">0</div>
        <button class="cnt-btn" onclick="changePipe(1)">+</button>
        <span style="font-size:0.8rem;color:var(--sub)">m</span>
      </div>
    </div>
    <div class="extra-item">
      <div class="extra-label">ì‹¤ì™¸ê¸° ì•µê¸€<small id="angle-price-label">ë²½ê±¸ì´ìš© 100,000ì›</small></div>
      <div class="extra-controls">
        <button class="toggle-btn" id="angle-toggle" onclick="toggleExtra('angle')"></button>
      </div>
    </div>
    <div class="extra-item">
      <div class="extra-label">ë°°ìˆ˜íŒí”„<small>100,000ì›</small></div>
      <div class="extra-controls">
        <button class="toggle-btn" id="pump-toggle" onclick="toggleExtra('pump')"></button>
      </div>
    </div>
    <div class="nav-row">
      <button class="btn-prev" onclick="goPrev(5)">â† ì´ì „</button>
      <button class="btn-next" onclick="showResult()">ê²¬ì  í™•ì¸ â†’</button>
    </div>
  </div>

</div><!-- /slider-wrap -->

<!-- ê²°ê³¼ -->
<div class="container-bottom">
  <div class="result-card hidden" id="result">
    <div class="result-title">ì˜ˆìƒ ê²¬ì  ê¸ˆì•¡</div>
    <div class="result-total" id="total-price">0 <span>ì›</span></div>
    <div class="result-breakdown" id="breakdown"></div>
    <div class="notice">
      â€» ìœ„ ê¸ˆì•¡ì€ ì˜ˆìƒ ê²¬ì ì´ë©°, í˜„ì¥ ìƒí™©ì— ë”°ë¼ ë³€ë™ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
      ì •í™•í•œ ê²¬ì ì€ ë°©ë¬¸ í›„ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
    </div>
  </div>
  <button class="kakao-share-btn hidden" id="kakao-btn" onclick="shareKakao()">
    <img src="https://developers.kakao.com/assets/img/about/logos/kakaolink/kakaolink_btn_small.png" alt="ì¹´ì¹´ì˜¤"/>
    ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê²¬ì  ì €ì¥í•˜ê¸°
  </button>
  <button class="reset-btn hidden" id="reset-btn" onclick="resetAll()">ğŸ”„ ë‹¤ì‹œ ê³„ì‚°í•˜ê¸°</button>
</div>

<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js" integrity="sha384-TiCUE00h649CAMonG018J2ujOgDKW/kVWlChEuu4jK2vxfAAD0eZxzCKakxg55G4" crossorigin="anonymous"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ìˆ˜ë„ê¶Œ ì§€ì—­ ì¢Œí‘œ ë°ì´í„° (ì‹œì²­/êµ¬ì²­/êµ°ì²­ ê¸°ì¤€)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const REGION_DATA = {
  'ì„œìš¸': {
    'ì¢…ë¡œêµ¬':[37.5735,126.9790],'ì¤‘êµ¬':[37.5641,126.9979],'ìš©ì‚°êµ¬':[37.5324,126.9896],
    'ì„±ë™êµ¬':[37.5635,127.0369],'ê´‘ì§„êµ¬':[37.5385,127.0823],'ë™ëŒ€ë¬¸êµ¬':[37.5744,127.0396],
    'ì¤‘ë‘êµ¬':[37.6063,127.0928],'ì„±ë¶êµ¬':[37.5894,127.0167],'ê°•ë¶êµ¬':[37.6396,127.0257],
    'ë„ë´‰êµ¬':[37.6688,127.0471],'ë…¸ì›êµ¬':[37.6542,127.0568],'ì€í‰êµ¬':[37.6027,126.9291],
    'ì„œëŒ€ë¬¸êµ¬':[37.5791,126.9368],'ë§ˆí¬êµ¬':[37.5638,126.9084],'ì–‘ì²œêµ¬':[37.5170,126.8666],
    'ê°•ì„œêµ¬':[37.5509,126.8495],'êµ¬ë¡œêµ¬':[37.4955,126.8877],'ê¸ˆì²œêµ¬':[37.4600,126.9001],
    'ì˜ë“±í¬êµ¬':[37.5263,126.8967],'ë™ì‘êµ¬':[37.5124,126.9395],'ê´€ì•…êµ¬':[37.4784,126.9516],
    'ì„œì´ˆêµ¬':[37.4836,127.0327],'ê°•ë‚¨êµ¬':[37.4979,127.0622],'ì†¡íŒŒêµ¬':[37.5145,127.1059],
    'ê°•ë™êµ¬':[37.5301,127.1238]
  },
  'ì¸ì²œ': {
    'ì¤‘êµ¬':[37.4738,126.6216],'ë™êµ¬':[37.4739,126.6431],'ë¯¸ì¶”í™€êµ¬':[37.4638,126.6500],
    'ì—°ìˆ˜êµ¬':[37.4106,126.6782],'ë‚¨ë™êµ¬':[37.4470,126.7314],'ë¶€í‰êµ¬':[37.5077,126.7218],
    'ê³„ì–‘êµ¬':[37.5375,126.7376],'ì„œêµ¬':[37.5456,126.6759],
    'ê°•í™”êµ°':[37.7473,126.4877],'ì˜¹ì§„êµ°':[37.4113,126.3260]
  },
  'ê²½ê¸°': {
    'ìˆ˜ì›ì‹œ':[37.2636,127.0286],'ì„±ë‚¨ì‹œ':[37.4201,127.1268],'ì˜ì •ë¶€ì‹œ':[37.7381,127.0437],
    'ì•ˆì–‘ì‹œ':[37.3943,126.9568],'ë¶€ì²œì‹œ':[37.5034,126.7660],'ê´‘ëª…ì‹œ':[37.4784,126.8650],
    'í‰íƒì‹œ':[36.9921,127.1129],'ë™ë‘ì²œì‹œ':[37.9038,127.0608],'ì•ˆì‚°ì‹œ':[37.3219,126.8309],
    'ê³ ì–‘ì‹œ':[37.6583,126.8320],'ê³¼ì²œì‹œ':[37.4292,126.9875],'êµ¬ë¦¬ì‹œ':[37.5943,127.1294],
    'ë‚¨ì–‘ì£¼ì‹œ':[37.6360,127.2165],'ì˜¤ì‚°ì‹œ':[37.1498,127.0774],'ì‹œí¥ì‹œ':[37.3800,126.8031],
    'êµ°í¬ì‹œ':[37.3614,126.9352],'ì˜ì™•ì‹œ':[37.3448,126.9679],'í•˜ë‚¨ì‹œ':[37.5395,127.2149],
    'ìš©ì¸ì‹œ':[37.2411,127.1776],'íŒŒì£¼ì‹œ':[37.7599,126.7798],'ì´ì²œì‹œ':[37.2724,127.4349],
    'ì•ˆì„±ì‹œ':[37.0079,127.2798],'ê¹€í¬ì‹œ':[37.6152,126.7155],'í™”ì„±ì‹œ':[37.1996,126.8312],
    'ê´‘ì£¼ì‹œ':[37.4296,127.2550],'ì–‘ì£¼ì‹œ':[37.7857,127.0456],'í¬ì²œì‹œ':[37.8942,127.2003],
    'ì—¬ì£¼ì‹œ':[37.2982,127.6375],'ì—°ì²œêµ°':[38.0966,127.0748],'ê°€í‰êµ°':[37.8314,127.5109],
    'ì–‘í‰êµ°':[37.4916,127.4875]
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ê±°ë¦¬ ê³„ì‚° ë° ì¶œì¥ë¹„
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function haversine(lat1, lon1, lat2, lon2) {
  const R = 6371;
  const dLat = (lat2-lat1)*Math.PI/180;
  const dLon = (lon2-lon1)*Math.PI/180;
  const a = Math.sin(dLat/2)**2 +
    Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
  return R * 2 * Math.asin(Math.sqrt(a));
}

function calcMoveFee(km) {
  // ì§ì„ ê±°ë¦¬ Ã— 1.3 ë³´ì •
  const d = km * 1.3;
  if (d <= 30)  return { fee: 0,      label: 'ì¶œì¥ë¹„ ë¬´ë£Œ', free: true };
  if (d <= 50)  return { fee: 20000,  label: 'ì¶œì¥ë¹„ 20,000ì›', free: false };
  if (d <= 70)  return { fee: 30000,  label: 'ì¶œì¥ë¹„ 30,000ì›', free: false };
  if (d <= 90)  return { fee: 40000,  label: 'ì¶œì¥ë¹„ 40,000ì›', free: false };
  if (d <= 110) return { fee: 50000,  label: 'ì¶œì¥ë¹„ 50,000ì›', free: false };
  if (d <= 130) return { fee: 60000,  label: 'ì¶œì¥ë¹„ 60,000ì›', free: false };
  return { fee: null, label: 'ë³„ë„ ë¬¸ì˜', free: false };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ì¹´ì¹´ì˜¤ SDK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
try {
  if (typeof Kakao !== 'undefined' && !Kakao.isInitialized()) {
    Kakao.init('bea973d99b01f7dbebc13733311c2579');
  }
} catch(e) { console.warn('ì¹´ì¹´ì˜¤ ì´ˆê¸°í™” ì‹¤íŒ¨', e); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ì•± ìƒíƒœ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const state = {
  step1: null, step3: null, step3Price: 0,
  step4maker: null, year: null,
  pipeCnt: 0, angle: false, pump: false, isInquiry: false,
  fromCoord: null, toCoord: null,
  fromLabel: '', toLabel: '',
  distKm: 0, moveFee: 0, moveLabel: ''
};

const BASE_PRICE = {
  'ì´ì „ì„¤ì¹˜': { 'ë²½ê±¸ì´':160000,'ìŠ¤íƒ ë“œ':190000,'íˆ¬ì¸ì›':310000,'ëƒ‰ë‚œë°©ë²½ê±¸ì´':null,'ëƒ‰ë‚œë°©ìŠ¤íƒ ë“œ':null },
  'ì¬ì„¤ì¹˜':   { 'ë²½ê±¸ì´':160000,'ìŠ¤íƒ ë“œ':190000,'íˆ¬ì¸ì›':310000,'ëƒ‰ë‚œë°©ë²½ê±¸ì´':null,'ëƒ‰ë‚œë°©ìŠ¤íƒ ë“œ':null }
};
const PIPE_PRICE  = { 'ë²½ê±¸ì´':15000,'ëƒ‰ë‚œë°©ë²½ê±¸ì´':15000,'ìŠ¤íƒ ë“œ':18000,'íˆ¬ì¸ì›':18000,'ëƒ‰ë‚œë°©ìŠ¤íƒ ë“œ':18000 };
const ANGLE_PRICE = { 'ë²½ê±¸ì´':100000,'ëƒ‰ë‚œë°©ë²½ê±¸ì´':100000,'ìŠ¤íƒ ë“œ':120000,'íˆ¬ì¸ì›':120000,'ëƒ‰ë‚œë°©ìŠ¤íƒ ë“œ':120000 };
const SMARTLINK=40000, PUMP=100000, STEP_MAX=5;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ì…€ë ‰íŠ¸ ì´ˆê¸°í™”
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function initSelects() {
  // ì‹œë„ ì˜µì…˜
  ['from-sido','to-sido'].forEach(id => {
    const sel = document.getElementById(id);
    ['ì„œìš¸','ì¸ì²œ','ê²½ê¸°'].forEach(s => {
      const o = document.createElement('option');
      o.value = s; o.textContent = s;
      sel.appendChild(o);
    });
  });

  // ë…„ì‹
  const ys = document.getElementById('year-select');
  for (let y=2025; y>=2006; y--) {
    const o = document.createElement('option');
    o.value=y; o.textContent=y+'ë…„'; ys.appendChild(o);
  }
})();

function onSidoChange(dir) {
  const sido = document.getElementById(dir+'-sido').value;
  const sigungu = document.getElementById(dir+'-sigungu');
  sigungu.innerHTML = '<option value="">êµ¬/êµ°/ì‹œ ì„ íƒ</option>';
  if (sido && REGION_DATA[sido]) {
    Object.keys(REGION_DATA[sido]).forEach(sg => {
      const o = document.createElement('option');
      o.value=sg; o.textContent=sg; sigungu.appendChild(o);
    });
    sigungu.disabled = false;
  } else {
    sigungu.disabled = true;
  }
  // ì¢Œí‘œ ì´ˆê¸°í™”
  if (dir==='from') { state.fromCoord=null; state.fromLabel=''; }
  else              { state.toCoord=null;   state.toLabel=''; }
  updateDistanceBadge();
}

function onSigunguChange() {
  const fSido = document.getElementById('from-sido').value;
  const fSg   = document.getElementById('from-sigungu').value;
  const tSido = document.getElementById('to-sido').value;
  const tSg   = document.getElementById('to-sigungu').value;

  if (fSido && fSg && REGION_DATA[fSido]?.[fSg]) {
    state.fromCoord = REGION_DATA[fSido][fSg];
    state.fromLabel = fSido==='ê²½ê¸°' ? fSg : `${fSido} ${fSg}`;
  }
  if (tSido && tSg && REGION_DATA[tSido]?.[tSg]) {
    state.toCoord = REGION_DATA[tSido][tSg];
    state.toLabel = tSido==='ê²½ê¸°' ? tSg : `${tSido} ${tSg}`;
  }
  updateDistanceBadge();
}

function updateDistanceBadge() {
  const badge = document.getElementById('distance-badge');
  const nextBtn = document.getElementById('location-next-btn');

  if (state.fromCoord && state.toCoord) {
    const km = haversine(...state.fromCoord, ...state.toCoord);
    const result = calcMoveFee(km);
    state.distKm  = Math.round(km * 1.3);
    state.moveFee = result.fee || 0;
    state.moveLabel = result.label;

    document.getElementById('dist-km-text').textContent =
      `ì´ë™ê±°ë¦¬ ì•½ ${state.distKm}km`;
    const feeEl = document.getElementById('dist-fee-text');
    feeEl.textContent = result.label;
    feeEl.className = 'dist-fee' + (result.free ? ' free' : '');

    badge.classList.add('show');
    nextBtn.disabled = (result.fee === null); // ë³„ë„ë¬¸ì˜ë©´ ë§‰ê¸°
    if (result.fee === null) nextBtn.textContent = 'ë³„ë„ ë¬¸ì˜ í•„ìš”';
    else nextBtn.textContent = 'ë‹¤ìŒ ë‹¨ê³„ â†’';
    nextBtn.disabled = false;
  } else {
    badge.classList.remove('show');
    nextBtn.disabled = true;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë‹¨ê³„ ì„ íƒ ì²˜ë¦¬
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function selectOpt(step, val, btn) {
  btn.closest('.step-card').querySelectorAll('.opt-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');

  if (step===1) {
    if (val==='ì¬ì„¤ì¹˜') {
      btn.classList.remove('selected');
      alert('ì¬ì„¤ì¹˜ ê²¬ì ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤! ê³§ ì¶”ê°€ë  ì˜ˆì •ì´ì—ìš” ğŸ˜Š');
      return;
    }
    state.step1 = val;
    setTimeout(() => goToStep(1, 2), 300);
  }

  if (step===3) {
    state.step3 = val;
    const price = BASE_PRICE[state.step1][val];
    state.step3Price = price||0;
    state.isInquiry = (price===null);
    document.getElementById('pipe-price-label').textContent = `1më‹¹ ${(PIPE_PRICE[val]||15000).toLocaleString()}ì›`;
    const isWall = val==='ë²½ê±¸ì´'||val==='ëƒ‰ë‚œë°©ë²½ê±¸ì´';
    document.getElementById('angle-price-label').textContent = isWall ? 'ë²½ê±¸ì´ìš© 100,000ì›' : 'ìŠ¤íƒ ë“œ/íˆ¬ì¸ì›ìš© 120,000ì›';

    if (state.isInquiry) setTimeout(() => showInquiryResult(), 300);
    else setTimeout(() => goToStep(3, 4), 300);
  }

  if (step===4) {
    state.step4maker = val;
    document.getElementById('smartlink-desc').classList.toggle('show', val==='ì‚¼ì„±');
    checkStep4();
  }
}

function selectYear(val) {
  state.year = val || null;
  checkStep4();
}

function checkStep4() {
  if (state.step4maker && state.year) {
    setTimeout(() => goToStep(4, 5), 300);
  }
}

function goNext(from) {
  if (from===2) goToStep(2, 3);
}
function goPrev(from) {
  goToStep(from, from-1, true);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  í™”ë©´ ì „í™˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goToStep(from, to, goingBack=false) {
  const fromEl = document.getElementById('step'+from);
  fromEl.style.transition = 'opacity 0.26s ease, transform 0.26s ease';
  fromEl.style.opacity = '0';
  fromEl.style.transform = goingBack ? 'translateX(50px) scale(0.97)' : 'translateX(-50px) scale(0.97)';

  setTimeout(() => {
    fromEl.classList.add('hidden');
    fromEl.style.transition=''; fromEl.style.opacity=''; fromEl.style.transform='';

    if (to===5 && !goingBack) {
      state.pipeCnt=0; state.angle=false; state.pump=false;
      document.getElementById('pipe-cnt').textContent='0';
      document.getElementById('angle-toggle').className='toggle-btn';
      document.getElementById('pump-toggle').className='toggle-btn';
    }
    if (to===4 && goingBack) {
      state.step4maker=null; state.year=null;
      document.getElementById('year-select').value='';
      document.getElementById('smartlink-desc').classList.remove('show');
      document.querySelectorAll('#step4 .opt-btn').forEach(b=>b.classList.remove('selected'));
    }

    const toEl = document.getElementById('step'+to);
    toEl.classList.remove('hidden','enter-right','enter-left');
    void toEl.offsetWidth;
    toEl.classList.add(goingBack ? 'enter-left' : 'enter-right');
    updateTabs(to);
  }, 240);
}

function showInquiryResult() {
  const fromEl = document.getElementById('step3');
  fromEl.style.transition='opacity 0.26s ease, transform 0.26s ease';
  fromEl.style.opacity='0'; fromEl.style.transform='translateX(-50px) scale(0.97)';
  setTimeout(()=>{
    fromEl.classList.add('hidden');
    fromEl.style.transition=''; fromEl.style.opacity=''; fromEl.style.transform='';
    updateTabs(null);
    const result=document.getElementById('result');
    result.classList.remove('hidden','enter-right');
    void result.offsetWidth; result.classList.add('enter-right');
    document.getElementById('total-price').innerHTML='ë³„ë„ ë¬¸ì˜ <span>í•„ìš”</span>';
    document.getElementById('breakdown').innerHTML=`
      <div class="breakdown-row"><span>${state.step3}</span><span>ë³„ë„ ê²¬ì </span></div>
      <div class="breakdown-row" style="margin-top:8px;opacity:0.85;font-size:0.8rem;">
        <span>ğŸ“ ëƒ‰ë‚œë°© ì œí’ˆì€ í˜„ì¥ í™•ì¸ í›„ ì •í™•í•œ ê²¬ì ì„ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.</span>
      </div>`;
    document.getElementById('kakao-btn').classList.remove('hidden');
    document.getElementById('reset-btn').classList.remove('hidden');
  },240);
}

function showResult() {
  const fromEl=document.getElementById('step5');
  fromEl.style.transition='opacity 0.26s ease, transform 0.26s ease';
  fromEl.style.opacity='0'; fromEl.style.transform='translateX(-50px) scale(0.97)';
  setTimeout(()=>{
    fromEl.classList.add('hidden');
    fromEl.style.transition=''; fromEl.style.opacity=''; fromEl.style.transform='';
    updateTabs(null);
    calcResult();
    const result=document.getElementById('result');
    result.classList.remove('hidden','enter-right');
    void result.offsetWidth; result.classList.add('enter-right');
    document.getElementById('kakao-btn').classList.remove('hidden');
    document.getElementById('reset-btn').classList.remove('hidden');
  },240);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ê²¬ì  ê³„ì‚°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function calcResult() {
  if(state.isInquiry) return;
  const items=[]; let total=0;
  const base=BASE_PRICE[state.step1][state.step3];
  items.push({label:`ê¸°ë³¸ ì„¤ì¹˜ë¹„ (${state.step3})`, price:base}); total+=base;

  // ì¶œì¥ë¹„
  if(state.moveFee > 0) {
    items.push({label:`ì´ì „ ì¶œì¥ë¹„ (ì•½ ${state.distKm}km)`, price:state.moveFee});
    total+=state.moveFee;
  }

  if(state.step4maker==='ì‚¼ì„±'){items.push({label:'ìŠ¤ë§ˆíŠ¸ë§í¬ (ì‚¼ì„± ì „ìš©)',price:SMARTLINK});total+=SMARTLINK;}
  if(state.pipeCnt>0){const pp=PIPE_PRICE[state.step3]*state.pipeCnt;items.push({label:`ë°°ê´€ ì¶”ê°€ ${state.pipeCnt}m`,price:pp});total+=pp;}
  if(state.angle){const ap=ANGLE_PRICE[state.step3];items.push({label:'ì‹¤ì™¸ê¸° ì•µê¸€',price:ap});total+=ap;}
  if(state.pump){items.push({label:'ë°°ìˆ˜íŒí”„',price:PUMP});total+=PUMP;}

  document.getElementById('total-price').innerHTML=total.toLocaleString()+' <span>ì›</span>';
  let html='';
  if(state.fromLabel && state.toLabel)
    html+=`<div class="breakdown-row"><span>ì´ì „ ì¥ì†Œ</span><span>${state.fromLabel} â†’ ${state.toLabel}</span></div>`;
  if(state.year)
    html+=`<div class="breakdown-row"><span>ì—ì–´ì»¨ ë…„ì‹</span><span>${state.year}ë…„ / ${state.step4maker}</span></div>`;
  items.forEach(i=>{
    html+=`<div class="breakdown-row"><span>${i.label}</span><span>${i.price.toLocaleString()}ì›</span></div>`;
  });
  html+=`<div class="breakdown-row total-row"><span>í•©ê³„</span><span>${total.toLocaleString()}ì›</span></div>`;
  document.getElementById('breakdown').innerHTML=html;
}

function updateTabs(activeStep) {
  for(let i=1;i<=STEP_MAX;i++){
    const tab=document.getElementById('tab'+i);
    tab.classList.remove('active','done');
    if(activeStep===null||i<activeStep) tab.classList.add('done');
    else if(i===activeStep) tab.classList.add('active');
  }
}

function changePipe(d){
  state.pipeCnt=Math.max(0,state.pipeCnt+d);
  document.getElementById('pipe-cnt').textContent=state.pipeCnt;
}
function toggleExtra(key){
  state[key]=!state[key];
  document.getElementById(key+'-toggle').className='toggle-btn'+(state[key]?' on':'');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ì¹´ì¹´ì˜¤ ê³µìœ 
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function shareKakao() {
  const rows=document.getElementById('breakdown').querySelectorAll('.breakdown-row');
  let itemText='';
  rows.forEach(row=>{
    const spans=row.querySelectorAll('span');
    if(spans.length===2) itemText+=`â€¢ ${spans[0].textContent} : ${spans[1].textContent}\n`;
  });
  const totalText=document.getElementById('total-price').textContent.trim();
  const date=new Date().toLocaleDateString('ko-KR',{year:'numeric',month:'long',day:'numeric'});
  const msg=`â„ï¸ JHì—ì–´ì»¨ ì„¤ì¹˜ ê²¬ì ì„œ\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n${itemText}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nğŸ’° ì´ ê²¬ì ê¸ˆì•¡: ${totalText}\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nğŸ“… ê²¬ì ì¼: ${date}\n\nâ€» í˜„ì¥ ìƒí™©ì— ë”°ë¼ ë³€ë™ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì •í™•í•œ ê²¬ì ì€ ë°©ë¬¸ í›„ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.`;
  try {
    if(typeof Kakao!=='undefined'&&Kakao.isInitialized()){
      Kakao.Share.sendDefault({
        objectType:'text', text:msg,
        link:{ mobileWebUrl:'https://enule85-hub.github.io/aircon-/hume.html', webUrl:'https://enule85-hub.github.io/aircon-/hume.html' }
      });
    } else {
      navigator.clipboard.writeText(msg).then(()=>alert('ê²¬ì  ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ëì–´ìš”!\nì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš” ğŸ˜Š'));
    }
  } catch(e) {
    navigator.clipboard.writeText(msg).then(()=>alert('ê²¬ì  ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ëì–´ìš”!\nì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš” ğŸ˜Š'));
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë¦¬ì…‹
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function resetAll(){
  state.step1=null; state.step3=null; state.step3Price=0;
  state.step4maker=null; state.year=null;
  state.pipeCnt=0; state.angle=false; state.pump=false; state.isInquiry=false;
  state.fromCoord=null; state.toCoord=null;
  state.fromLabel=''; state.toLabel='';
  state.distKm=0; state.moveFee=0; state.moveLabel='';

  document.getElementById('result').classList.add('hidden');
  document.getElementById('kakao-btn').classList.add('hidden');
  document.getElementById('reset-btn').classList.add('hidden');
  document.getElementById('smartlink-desc').classList.remove('show');
  document.getElementById('distance-badge').classList.remove('show');

  ['from-sido','to-sido'].forEach(id => document.getElementById(id).value='');
  ['from-sigungu','to-sigungu'].forEach(id => {
    const el = document.getElementById(id);
    el.innerHTML='<option value="">êµ¬/êµ°/ì‹œ ì„ íƒ</option>';
    el.disabled=true;
  });
  document.getElementById('year-select').value='';
  document.getElementById('location-next-btn').disabled=true;
  document.getElementById('location-next-btn').textContent='ë‹¤ìŒ ë‹¨ê³„ â†’';
  document.querySelectorAll('.opt-btn').forEach(b=>b.classList.remove('selected'));

  for(let i=2;i<=STEP_MAX;i++) document.getElementById('step'+i).classList.add('hidden');
  const s1=document.getElementById('step1');
  s1.classList.remove('hidden','enter-right','enter-left');
  void s1.offsetWidth; s1.classList.add('enter-left');
  updateTabs(1);
}

updateTabs(1);
</script>
</body>
</html>
